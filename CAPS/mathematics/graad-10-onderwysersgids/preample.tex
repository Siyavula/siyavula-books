\usepackage{graphics}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{array}
\usepackage{icomma}
\usepackage{tikz, ifthen}

\usepackage{setspace} % linespacing
\onehalfspacing

\usepackage{parskip}
\setlength{\parskip}{25.6pt plus0pt minus0pt}


\usetikzlibrary{arrows,shapes,backgrounds,patterns,decorations.pathreplacing,decorations.pathmorphing}

% <Must include this>
% Definitions for coin images
%\def\coinheads{\draw (0,0) circle (0.9cm); \draw (0,0) circle (0.72cm); \draw (0,0) node {\Huge\textbf{H}};}
%\def\cointails{\draw (0,0) circle (0.9cm); \draw (0,0) circle (0.72cm); \draw (0,0) node {\Huge\textbf{T}};}
% Definitions for dice images
%\input{Gr10-Probability-images/makedice}
% Definitions for Venn images
%\input{Gr10-Probability-images/venn_union_intersection}
% </Must include this>
   

\usepackage{extsizes}


\newenvironment{toc}%
    {\begin{description}\setlength{\topsep}{0cm}\setlength{\itemsep}{0cm}%%
    \setlength{\parskip}{0cm}\setlength{\parsep}{0cm}%%
    \setlength{\partopsep}{0cm}}
    {\end{description}}

    \newenvironment{indexheading}%
    {\begin{description}\setlength{\topsep}{0cm}\setlength{\itemsep}{0cm}%%
    \setlength{\parskip}{0cm}\setlength{\parsep}{0cm}%%
    \setlength{\partopsep}{0cm}
    \setlength{\labelwidth}{0cm}\setlength{\labelsep}{0cm}%
    \setlength{\leftmargin}{-1cm} \item[] \noindent}
    {\end{description}}


    \usepackage{marginnote}
  
    \usepackage[paper=a4paper, 
      lmargin=0.1\paperwidth, rmargin=0.25\paperwidth, 
      tmargin=1in, bmargin=1in,
      twoside, centering,
      includehead, marginsep=3mm, marginparwidth=0.225\paperwidth ]{geometry}
   \usepackage{etoolbox} 
    \usepackage{wrapfig}
    \usepackage[strict]{changepage}      
    \usepackage{layouts}
    \usepackage{multicol}
    \usepackage{amsmath} %for \underset, \overset, and more?
    \usepackage{amssymb} %for set of reals, integers, etc..., \triangleq
    \usepackage{alltt}   %for codeblocks
    \usepackage{url} %for nice url breaks
    \usepackage{graphicx} % for figure support
    \usepackage{epstopdf}
    \usepackage{subfigure}
    \usepackage{tabularx}
    \usepackage{supertabular}
    \usepackage{xtab}
    \usepackage{multirow}
    \usepackage{float}
    \usepackage{ragged2e} 
    \usepackage{array}
    \usepackage{mathrsfs}
    \usepackage{textcomp}
%    \usepackage[cjkjis,mathletters,autogenerated,tipa]{ucs}
    \usepackage{amsmath, amsthm, amssymb}
    \usepackage{xcolor}

    \usepackage{pst-all}
    \usepackage{pst-eucl}        %Jo
    \usepackage{pst-poly}        %Jo
    \usepackage{pst-spectra}
    \usepackage{pst-slpe}
    \usepackage{pst-math}

    %% ************* NB ************
    %% The order in which pstricks packages are loaded
    %% matters - so I copied the order from pst-all.sty
    %% and then added the two additional packages at the end.
    %% ************* End NB ************

    %% ************* Packages ************
    \usepackage{pst-circ}
    \usepackage{pst-lens}
    \usepackage{pst-optic}         %Jo
    \usepackage{pstricks-add}         %Jo
    \usepackage{pst-labo}         %Jo  
    \usepackage{pst-3dplot} 
    \usepackage{pst-solides3d}
    \usepackage{auto-pst-pdf}
    \usepackage{mdframed}
    \sffamily
    \pagestyle{headings}

    \usepackage[utf8x]{inputenc}
    \usepackage[C40,T1]{fontenc}
    \renewcommand*\sfdefault{uop}
    \renewcommand*\familydefault{\sfdefault}    
    \usepackage{calc}
    \usepackage{ifthen}
    %\usepackage{breqn}
%    \usepackage{ulem}

%    \setlength{\emergencystretch}{3em}
    \renewcommand{\labelenumi}{\textbf{\arabic*{enumi}.}}
    \renewcommand{\thesubfigure}{(\alph{subfigure})}
    \renewcommand{\labelitemi}{\ensuremath{\bullet} }
    \renewcommand{\labelitemii}{\ensuremath{\cdot} }
\renewcommand{\partname}{Deel}
    \usepackage{enumerate}
    \usepackage{enumitem}
    \setcounter{tocdepth}{1}
    \DeclareUnicodeCharacter {9653} {\bigtriangleup}
    \DeclareUnicodeCharacter {183} {\ensuremath{\cdot}}
    \DeclareUnicodeCharacter {785} {\textasciibreve}
    \DeclareUnicodeCharacter {787} {'}
    \DeclareUnicodeCharacter {788} {`}
    \DeclareUnicodeCharacter {789} {'}
    \DeclareUnicodeCharacter {940} {[U+03AC]}
    \DeclareUnicodeCharacter {941} {[U+03AD]}
    \DeclareUnicodeCharacter {942} {[U+03AE]}
    \DeclareUnicodeCharacter {943} {[U+03AF]}
    \DeclareUnicodeCharacter {970} {\"{i}}
    \DeclareUnicodeCharacter {972} {[U+03CC]}
    \DeclareUnicodeCharacter {973} {[U+03CD]}
    \DeclareUnicodeCharacter {974} {[U+03CE]}
    \DeclareUnicodeCharacter {978}  {\ensuremath{\Upsilon}}
    \DeclareUnicodeCharacter {988}  {\ensuremath{\digamma}}
    \DeclareUnicodeCharacter {8260} {/}
    \DeclareUnicodeCharacter {8289} {}
    \DeclareUnicodeCharacter {8290} {}
    \DeclareUnicodeCharacter {8407} {\ensuremath{\rightarrow}}
    \DeclareUnicodeCharacter {8474} {\ensuremath{\mathbb{Q}}}
    \DeclareUnicodeCharacter {8484} {\ensuremath{\mathbb{Z}}}
    \DeclareUnicodeCharacter {8497} {\ensuremath{\mathcal{F}}}
    \DeclareUnicodeCharacter {8519} {\ensuremath{\mathbb {e}}}
    \DeclareUnicodeCharacter {8520} {\ensuremath{\mathbb {i}}}
    \DeclareUnicodeCharacter {8596} {\ensuremath{\leftrightarrow}}
    \DeclareUnicodeCharacter {8614} {\ensuremath{\mapsto}}
    \DeclareUnicodeCharacter {8788} {:=}
    \DeclareUnicodeCharacter {9001} {\ensuremath{\textless}}
    \DeclareUnicodeCharacter {9002} {\ensuremath{\textgreater}}   
    \DeclareUnicodeCharacter {9474} {\ensuremath{\textbar}}
    \DeclareUnicodeCharacter {10003} {\checkmark}
  
    \DeclareUnicodeCharacter {61168}{\ensuremath{\jmath}}
    \DeclareUnicodeCharacter {61237}{\ensuremath{\mathscr{A}}}
    \DeclareUnicodeCharacter {61238}{\ensuremath{\mathscr{C}}}
    \DeclareUnicodeCharacter {61239}{\ensuremath{\mathscr{D}}}
    \DeclareUnicodeCharacter {61240}{\ensuremath{\mathscr{G}}}
    \DeclareUnicodeCharacter {61241}{\ensuremath{\mathscr{J}}}
    \DeclareUnicodeCharacter {61242}{\ensuremath{\mathscr{K}}}
    \DeclareUnicodeCharacter {61243}{\ensuremath{\mathscr{N}}}
    \DeclareUnicodeCharacter {61244}{\ensuremath{\mathscr{O}}}
    \DeclareUnicodeCharacter {61245}{\ensuremath{\mathscr{P}}}
    \DeclareUnicodeCharacter {61246}{\ensuremath{\mathscr{Q}}}
    \DeclareUnicodeCharacter {61247}{\ensuremath{\mathscr{S}}}
    \DeclareUnicodeCharacter {61248}{\ensuremath{\mathscr{T}}}
    \DeclareUnicodeCharacter {61249}{\ensuremath{\mathscr{U}}}
    \DeclareUnicodeCharacter {61250}{\ensuremath{\mathscr{V}}}
    \DeclareUnicodeCharacter {61251}{\ensuremath{\mathscr{W}}}
    \DeclareUnicodeCharacter {61252}{\ensuremath{\mathscr{X}}}
    \DeclareUnicodeCharacter {61253}{\ensuremath{\mathscr{Y}}}
    \DeclareUnicodeCharacter {61254}{\ensuremath{\mathscr{Z}}}
    \DeclareUnicodeCharacter {61327}{\ensuremath{\mathbb {E}}}
    \DeclareUnicodeCharacter {61328}{\ensuremath{\mathbb {F}}}
    \DeclareUnicodeCharacter {62838}{\ensuremath{\longleftarrow}}
    \DeclareUnicodeCharacter {62839}{\ensuremath{\longrightarrow}}
    \DeclareUnicodeCharacter {62843}{\ensuremath{\leftrightarrow}}




\newcommand{\chapterstartvideo}[1]{
See introductory video: (\raisebox{-0.2em}{\includegraphics[height=1em]{../../icons/video.pdf}} Video: #1 at www.everythingmaths.co.za)\par
}

\newcommand{\simulation}[2]{
See simulation: #1 (\raisebox{-0.2em}{\includegraphics[height=1em]{../../icons/video.pdf}} Simulation: #2 at www.everythingmaths.co.za)\par
}


\newcommand{\mindsetvid}[2]{
See video about: #1 (\raisebox{-0.2em}{\includegraphics[height=1em]{../../icons/video.pdf}} Video: #2 at www.everythingmaths.co.za)\par
}


\newcommand{\IFact}[1]{
\marginpar{%odd
\begin{minipage}[m]{0.225\paperwidth}
\begin{mdframed}[linecolor=black, linewidth=1.0pt,leftmargin=15pt, rightmargin=15pt]
\textbf{\textit{FACT}}
\end{mdframed}
\begin{mdframed}[backgroundcolor=lightgray, linecolor=lightgray,skipabove=-4pt, leftmargin=15pt, rightmargin=15pt]
\small #1
\end{mdframed}
\end{minipage}
}
}

\newcommand{\practiceinfo}[0]{
\par\vspace*{2em}
\raisebox{-0.7em}{\includegraphics[scale=0.5]{../../icons/aplus.pdf}} More practice 
\phantom{xx}\raisebox{-0.7em}{\includegraphics[scale=0.5]{../../icons/video.pdf}} video solutions 
\phantom{xx}\raisebox{-0.7em}{\includegraphics[scale=0.5]{../../icons/help.pdf}} or help at www.everythingmaths.co.za
\vspace*{2em}
}

\newcommand{\Definition}[2]{
\begin{mdframed}[nobreak=true, linewidth=1,linecolor=black, skipabove=36pt]%
\vspace*{10pt}
\leftskip20pt
\rightskip20pt
{\Large\textsl{DEFINITION: } \textit{#1}}

\par
#2

\vspace*{28pt}
\end{mdframed}
}

\newcommand{\Identity}[1]{
\begin{mdframed}[linewidth=1pt,linecolor=black,skipbelow=\baselineskip,%
skipabove=\baselineskip]%
%\uppercase{\textsl{#1}}\nopagebreak
#1
\end{mdframed}
}


\newcommand{\Tip}[1]{
\marginpar{%odd
\begin{minipage}[m]{0.225\paperwidth}
\begin{mdframed}[linecolor=black, linewidth=1.0pt, leftmargin=15pt, rightmargin=15pt]
\textbf{\textit{Tip}}
\end{mdframed}
\begin{mdframed}[backgroundcolor=lightgray, linecolor=lightgray,skipabove=-4pt,leftmargin=15pt, rightmargin=15pt]
\small #1
\end{mdframed}
\end{minipage}
}
}

\newcommand{\Warning}[1]{
\begin{mdframed}[linewidth=4pt,%
linecolor=red%
]
%\begin{mdframed}[linewidth=2pt,linecolor=red]%
\vspace{3mm}
\begin{center}
\noindent%
\textbf{Warning:}\par
#1
\end{center}
\end{mdframed}
\vspace{3mm}}


\newcommand{\Note}[1]{
\marginpar{%odd
\begin{minipage}[h]{0.225\paperwidth}

\begin{mdframed}[linecolor=siyavula-dark-gray, backgroundcolor=siyavula-dark-gray, skipbelow=-pt, leftmargin=15pt, rightmargin=15pt]
\textbf{\textit{Note}}
\end{mdframed}
\begin{mdframed}[backgroundcolor=siyavula-gray, linecolor=siyavula-gray,leftmargin=15pt, rightmargin=15pt, skipabove=-4pt]
\small #1
\end{mdframed}
\end{minipage}
}
}

                

    \setlength{\parskip}{2ex}

    \setlength{\parindent}{0pt}

    
	\newenvironment{note}[1]%
	{\begin{list}{}{%
 	\setlength{\labelsep}{0pt}\setlength{\rightmargin}{20pt}%
        {\leftmargin}{20pt}%
	\setlength{\labelwidth}{0pt}\setlength{\listparindent}{0pt}}%
        \item\textbf{\textsc{#1}}}%
	{\end{list}}

  

    \newenvironment{cnxcaption}%
	{\begin{list}{}{%
 	\setlength{\labelsep}{0pt}\setlength{\rightmargin}{25pt}%
        \setlength{\leftmargin}{25pt}%
	\setlength{\labelwidth}{0pt}\setlength{\listparindent}{0pt}}%
        \item}%
	{\end{list}}

        \newenvironment{example}{%
          \noindent
          \begingroup
          \leftskip=20pt\rightskip=\leftskip
        }{%
          \vspace{\rubberspace}\par
          \endgroup
        }

        %\newenvironment{exercise}{\begin{example}}
        %{\end{example}}

% Inserted by MH to get step number etc. to work nicely
% My attempt to define a worked example environment
\newcounter{stepcounter}
\setcounter{stepcounter}{1}

\newcounter{workedexamplecounter}
\setcounter{workedexamplecounter}{1}


%EZ new counters for exercises, 
\newcounter{exercisecounter}
\setcounter{exercisecounter}{1}
% make it reset for new chapters
\makeatletter
\@addtoreset{exercisecounter}{chapter}
\makeatother


\newcommand{\westep}[1]
{\par \vspace{3mm}%\pagebreak[1]
\leftskip20pt
\noindent
\textit{Step \arabic{stepcounter}} : \textit{\textbf{#1}}
\par\noindent
\leftskip50pt
\addtocounter{stepcounter}{1}}

\definecolor{siyavula-gray}{RGB}{242,242,242}
\definecolor{siyavula-dark-gray}{RGB}{205,204,204}

\newenvironment{wex}[3]{
\newlength{\myfloatsep}
\setlength{\myfloatsep}{\floatsep}
\setlength{\floatsep}{2mm}
\begin{quotation}
\noindent
\newlength{\oldparindent}
\setlength{\oldparindent}{\parindent}
\setlength{\parindent}{20pt}

\ifdimless{\pagegoal-\pagetotal}{4cm}%4em play with this 
{\clearpage\vspace*{-\topskip}}{} 


\begin{mdframed}[linewidth=1pt,linecolor=black, leftmargin=10pt, innertopmargin=8pt, innerbottommargin=6pt, skipbelow=0pt]
{\Large\textbf{\textit{Worked Example \arabic{workedexamplecounter}:}} } {\Large\textit{#1}}
\vspace*{0pt}
\end{mdframed}
\vspace*{-2pt}
\begin{mdframed}[linecolor=siyavula-gray,backgroundcolor=siyavula-gray, leftmargin=10pt, skipbelow=18pt]
{\large\textbf{\textit{QUESTION}}} \vspace*{4pt} 
\hrule
\vspace*{18pt}
\noindent
\textit{\noindent #2}
\vspace*{28pt}
\par\noindent
\textbf{\textit{SOLUTION}}\vspace*{4pt}
\hrule
\vspace*{18pt}
\noindent
 #3%
\vspace*{28pt}
\hrule
\addtocounter{workedexamplecounter}{1}\setcounter{stepcounter}{1}%
%\vspace{.25cm}
}%
{%
\end{mdframed}
\end{quotation}
%\nopagebreak[4]
%\begin{pspicture}(0,0)(10,0.01)
% \psline[linecolor=gray,linewidth=3pt]{-}(0,0)(10,0)
% \psline[linecolor=gray]{-}(10,0)(10,2)
%\end{pspicture}
\setlength{\parindent}{\oldparindent}
\setlength{\floatsep}{\myfloatsep}
}








\newenvironment{wex2}[3]
{% This is a picture at the beginning, a line or bar or something else
% this command puts a bar in the margin and sets the bar width
% Now we set margins
% \begin{center}
%\pagebreak
%\begin{flushleft}
%\begin{pspicture}(0,0)(10,0.01)
% \psline[linecolor=gray,linewidth=3pt]{-}(0,0)(10,0)
% \psline[linecolor=gray]{-}(0,0)(0,-2)
%\end{pspicture}
%\end{flushleft}
%\end{center}
\begin{quotation}
\noindent
\vspace{./5cm}
\setlength{\parindent}{0pt}
%% Title and counter
\rput(-2.0,0){\pspencil}\noindent
\begin{mdframed}[linewidth=2,linecolor=black,backgroundcolor=lightgray]
\textbf{\textit{Worked Example \arabic{workedexamplecounter}: }
#1}\par
\textbf{Question:} #2\par
\textbf{Answer}\par #3%
\addtocounter{workedexamplecounter}{1}\setcounter{stepcounter}{1}%
\par%\vspace{.25cm}
}%
{%
\end{mdframed}
\end{quotation}
%\nopagebreak[4]
\begin{flushright}
%\begin{pspicture}(0,0)(10,0.01)
% \psline[linecolor=gray,linewidth=3pt]{-}(0,0)(10,0)
% \psline[linecolor=gray]{-}(10,0)(10,2)
%\end{pspicture}
\end{flushright}
\setlength{\parindent}{\saveparindentlength}}



\newenvironment{solutions}[1]
{
\ifdimless{\pagegoal-\pagetotal}{4cm}%4em play with this 
{\clearpage\vspace*{-\topskip}}{} 

\solutionsheading

%\hrule width \textwidth height 1pt\\
\begin{quotation}
\noindent
\setlength{\parindent}{0pt}
%\vspace{\baselineskip}
%\textbf{\textit{Exercises:}
%#1}
\par
}%
{%
\end{quotation}
\setlength{\parindent}{\saveparindentlength}
}




\newenvironment{exercises}[1]
{
\ifdimless{\pagegoal-\pagetotal}{4cm}%4em play with this 
{\clearpage\vspace*{-\topskip}}{} 

\exercisesheading

%\hrule width \textwidth height 1pt\\
\begin{quotation}
\noindent
\setlength{\parindent}{0pt}
%\vspace{\baselineskip}
%\textbf{\textit{Exercises:}
%#1}
\par
}%
{%
\end{quotation}
\setlength{\parindent}{\saveparindentlength}
}




\newenvironment{eocsolutions}[1]
{
\eocsolutionsheading

%\hrule width \textwidth height 1pt\\
\begin{quotation}
\noindent
%\vspace{.5cm}
\setlength{\parindent}{0pt}
%\textbf{\textit{End of chapter exercises:}
%#1}
\par
}%
{%
\end{quotation}
\setlength{\parindent}{\saveparindentlength}
}



\newenvironment{eocexercises}[1]
{
\eocexercisesheading

%\hrule width \textwidth height 1pt\\
\begin{quotation}
\noindent
%\vspace{.5cm}
\setlength{\parindent}{0pt}
%\textbf{\textit{End of chapter exercises:}
%#1}
\par
}%
{%
\end{quotation}
\setlength{\parindent}{\saveparindentlength}
}

\newenvironment{f_experiment}[1]
{
\begin{quotation}
\begin{mdframed}[linewidth=5,linecolor=darkgray]
\noindent
\vspace{.5cm}
\setlength{\parindent}{0pt}
\textbf{\textit{Formal Experiment:}
#1}\par
}%
{%
\end{mdframed}
\end{quotation}
\setlength{\parindent}{\saveparindentlength}}


\newenvironment{i_experiment}[1]
{
\begin{quotation}
\begin{mdframed}[linewidth=5,linecolor=lightgray]
\noindent
\vspace{.5cm}
\setlength{\parindent}{0pt}
\textbf{\textit{Informal Experiment:}
#1}\par
}%
{%
\end{mdframed}
\end{quotation}
\setlength{\parindent}{\saveparindentlength}}

\newenvironment{g_experiment}[1]
{
\begin{quotation}
\begin{mdframed}[linewidth=5,linecolor=lightgray]
\noindent
\vspace{.5cm}
\setlength{\parindent}{0pt}
\textbf{\textit{General Experiment:}
#1}\par
}%
{%
\end{mdframed}
\end{quotation}
\setlength{\parindent}{\saveparindentlength}}

\newenvironment{activity}[1]
{

\setlength{\saveparindentlength}{\parindent}
\setlength{\parindent}{0pt}

\ifdimless{\pagegoal-\pagetotal}{4em}%4em play with this 
{\clearpage\vspace*{-\topskip}}{} 

\begin{quotation}
\vspace*{25.6pt}
{  \fontsize{12}\bfseries\itshape
\begin{tikzpicture}[remember picture,overlay]
    \node[anchor=west ,text centered, xshift=-40pt]
      {\begin{tikzpicture}[remember picture, overlay]
        \draw[color=white, draw=black, linewidth=1pt] (0,0) rectangle
          (0.2\textwidth, 28pt);
       \node[anchor=west, yshift=14pt, xshift=4pt, text centered]
              { \bfseries ~ \color{black} Activity:};
       \end{tikzpicture}
    };
    
% now the white bar to the end of the paragraph
    \node[anchor=west, xshift=45pt]{
      \begin{tikzpicture}[remember picture, overlay]
        \draw[fill=white, draw=black, linewidth=1pt] (0,0) rectangle
          (0.8\textwidth-5pt,28pt);
         \node[anchor=west, yshift=14pt, xshift=0pt, text centered]
              { \textit{#1} };

       \end{tikzpicture}


      };
   \end{tikzpicture}

}

\begin{mdframed}[leftline=true, topline=false, bottomline=false, rightline=false, linecolor=siyavula-dark-gray, linewidth=10pt]
}%
{%
\vspace{5pt}

\end{mdframed}
\end{quotation}
\setlength{\parindent}{\saveparindentlength}}

\newenvironment{groupdiscussion}[1]
{
\begin{quotation}
\noindent
\setlength{\parindent}{0pt}
\hrule width \textwidth height 1pt\\
\vspace{1pt}\hrule width \textwidth height 1pt\vspace{7pt}
\textbf{\Large\textit{Group Discussion:}
#1}
\vspace{5pt}
\hrule width \textwidth height 1pt
\vspace{5pt}
}%
{%
\vspace{5pt}
\hrule width \textwidth height 1pt
\end{quotation}
\setlength{\parindent}{\saveparindentlength}}


\newenvironment{oldgroupdiscussion}[1]
{
\begin{quotation}
\noindent
\vspace{.5cm}
\setlength{\parindent}{0pt}
\textbf{\textit{Group Discussion:}
#1}\par
}%
{%
\end{quotation}
\setlength{\parindent}{\saveparindentlength}}

\newenvironment{casestudy}[1]
{
\begin{quotation}
\noindent
\vspace{.5cm}
\setlength{\parindent}{0pt}
\textbf{\textit{Case Study:}
#1}\par
}%
{%
\end{quotation}
\setlength{\parindent}{\saveparindentlength}}

\newenvironment{project}[1]
{
\begin{quotation}
\noindent
\vspace{.5cm}
\setlength{\parindent}{0pt}
\textbf{\textit{Project:}
#1}\par
}%
{%
\end{quotation}
\setlength{\parindent}{\saveparindentlength}}

\newenvironment{Investigation}[1]
{
\begin{quotation}
\noindent
\vspace{.5cm}
\setlength{\parindent}{0pt}
\textbf{\textit{Investigation:}
#1}\par
}%
{%
\end{quotation}
\setlength{\parindent}{\saveparindentlength}}




        \newenvironment{cnxrule}{\begin{example}}
        {\end{example}}

\newenvironment{exercise}{\textbf{\par Needs to be changed to wex environment\par}\begin{example}}
        {\end{example}}


        \newenvironment{definition}{\begin{example}}
        {\end{example}}

        \newenvironment{listname}{\vspace{\rubberspace}\par\noindent{}}{\vspace*{0pt}
        \nopagebreak}

    \newcommand{\lessthan}{\ensuremath{<}}
    \newcommand{\greatthan}{\ensuremath{>}}

    % --------------------------------------------
    % Hacks for honouring row/entry/@align
    % (\hspace not effective when in paragraph mode)
    % Naming convention for these macros is:
    % 'docbooktolatex' 'align' {alignment-type} {position-within-entry}
    % where r = right, l = left, c = centre
    \newcommand{\docbooktolatexalign}[2]{\protect\ifvmode#1\else\ifx\LT@@tabarray\@undefined#2\else#1\fi\fi}
    \newcommand{\docbooktolatexalignll}{\docbooktolatexalign{\raggedright}{}}
    \newcommand{\docbooktolatexalignlr}{\docbooktolatexalign{}{\hspace*\fill}}
    \newcommand{\docbooktolatexaligncl}{\docbooktolatexalign{\centering}{\hfill}}
    \newcommand{\docbooktolatexaligncr}{\docbooktolatexalign{}{\hspace*\fill}}
    \newcommand{\docbooktolatexalignrl}{\protect\ifvmode\raggedleft\else\hfill\fi}
    \newcommand{\docbooktolatexalignrr}{}

    % ------------------------------------------
    % Break long chapter titles in running heads
    \makeatletter
      \def\@evenhead{\thepage\hfil\parbox{5in}{\raggedleft\slshape\leftmark}}%
    \makeatother

    % ------------------------------------------
    % Lengths etc. for tables
    \newlength\mytablewidth  % full width of table
    \newlength\mytablespace  % non-content hspace in table (tabcolseps and rule widths)
    \newlength\mytableroom   % content hspace in table
    \newlength\mycolwidth
    \newlength\myfixedwidth  % sum of widths of columns that have fixed widths
    \newlength\mystarwidth   % length of one star factor
    \newlength\myspanwidth
    \newsavebox\mytablebox
    \newlength\mytableboxwidth
    \newlength\mytableboxheight
    \newlength\mytableboxdepth
    \newcolumntype{L}[1]{>{\raggedright\hspace{0pt}}p{#1}}
    \newcolumntype{C}[1]{>{\centering\hspace{0pt}}p{#1}}
    \newcolumntype{R}[1]{>{\raggedleft\hspace{0pt}}p{#1}}
    \newcolumntype{J}[1]{>{\hspace{0pt}}p{#1}}

    % ------------------------------------------
    % savebox and length for conditional typesetting of block math
    \newsavebox\mymathbox
    \newlength\mymathboxwidth

    % ------------------------------------------
    % Command to help dmath* be pseudo-text-math
    \newcommand*\nodisplayskips{%
      \setlength\abovedisplayskip{0pt}%
      \setlength\abovedisplayshortskip{0pt}%
      \setlength\belowdisplayskip{0pt}%
      \setlength\belowdisplayshortskip{0pt}%
    }

    \newlength\figurerulewidth
    \setlength\figurerulewidth{\textwidth}
    \addtolength\figurerulewidth{-50pt}
    
    \newlength\rubberspace
    \setlength\rubberspace{3pt plus 3pt}
    
    % Give tables more vertical padding, so that math looks better
    \renewcommand{\arraystretch}{1.4}
    
    
  
    \usepackage{fancyhdr}
    \pagestyle{fancy}
    \fancyfoot[C]{}
    \fancyfoot[LE,RO]{\thepage}





% border icons
\newcommand{\psintfact}%
{%
\rput(0,0){\begin{tabular}{c}\textbf{Interesting}\\ \textbf{Fact}%
\end{tabular}}
}

\newcommand{\psfact}%
{%
\begin{pspicture}(-.5,-.5)(.5,.5)
 \psintfact
 \PstLens[LensSize=0.5,LensRotation=-60,LensMagnification=1.5](-.04,-.1){\psintfact}
\end{pspicture}
}





%Physics Definitions
\def\rope{\psline(0,0.2)(5,.2)\psline(0,0)(5,0)\multirput(0,0)(0.2,0){25}{\psline(0,0)(0.2,0.2)}}

\def\cart{\psframe(0,0.4)(1,1)\pscircle(0.2,0.2){0.2}\pscircle(0.8,0.2){0.2}}

% Arrow for objects and images
\newpsobject{oi}{psline}{arrowsize=6pt, arrowlength=1.5, arrowinset=0, linewidth=2pt}
\psset{lensHeight=3,lensColor=lightgray}
\newpsobject{PrincipalAxis}{psline}{linewidth=0.5pt,linecolor=gray}
\newcommand{\ms}{m$\cdot$s$^{-1}$}                %m/s in text




%
% Counters for the shortcodes at the beginning of sections    
%

\newcounter{shortcodecounter}
\setcounter{shortcodecounter}{1}





% fancy headings

\usepackage{tikz}
\usepackage[explicit]{titlesec}

\newcommand*\chapterlabel{}

\titleformat{\chapter}
  {\gdef\chapterlabel{}
   \normalfont\sffamily\fontsize{38}\bfseries\slshape}
  {\gdef\chapterlabel{\thechapter\ }}{0pt}
  {\begin{tikzpicture}[remember picture,overlay]
    \node[yshift=-4cm] at (current page.north west)
      {\begin{tikzpicture}[remember picture, overlay]
        \shade[left color=white, right color=gray] (0,0) rectangle
          (1.2\paperwidth,4cm);
        \node[anchor=west,text centered, yshift=2.5cm, xshift=1cm]
              {
              \begin{minipage}{1.2\textwidth}
              \raggedright
              \phantom{xxx}\color{black} #1
              \end{minipage}
              };
        \node[anchor=west,text centered, yshift=2.0cm, xshift=0.85\paperwidth]
              {\begin{minipage}{\textwidth}
              \color{white}\chapterlabel
              \end{minipage}
              };
      \end{tikzpicture}
      };
   \end{tikzpicture}
  }
\titlespacing*{\chapter}{1.5cm}{1cm}{1cm}



\newcommand*\sectionlabel{}
\titleformat{\section}
  {\gdef\sectionlabel{}
   \normalfont\sffamily\fontsize{22}\normalfont\itshape}
  {\gdef\sectionlabel{\thesection}}{0pt}
{
\begin{tikzpicture}[remember picture,overlay]
   \node[anchor=west, yshift=-1.5cm, xshift=-4.0cm]
      {\begin{tikzpicture}[remember picture, overlay]
        \draw[fill=siyavula-gray, color=siyavula-dark-gray, xshift=-\marginparwidth] (0,0) rectangle
          (1.5\paperwidth,2.0cm);
        \node[anchor=west,text centered ,yshift=1.0cm, xshift=\hoffset+0.45\marginparwidth]
              {
              \begin{minipage}{0.85\textwidth}
              \raggedright
              \color{black} #1
              \end{minipage}
              };
        \node[anchor=east,text centered, yshift=1.0cm, xshift=\hoffset+0.45\marginparwidth+1.1\textwidth]
              {\Large\color{black} };
       \end{tikzpicture}
      };
   \end{tikzpicture}
\addtocounter{shortcodecounter}{1}
}
\titlespacing*{\section}{1cm}{1cm}{2cm}




\newcommand*\subsectionlabel{}
\titleformat{\subsection}
  {\gdef\subsectionlabel{}
   \normalfont\sffamily\fontsize{18}\bfseries\slshape}
  {\gdef\subsectionlabel{\thesubsection}}{0pt}
  {\begin{tikzpicture}[remember picture,overlay]
   \node[anchor=west, yshift=-1.5cm, xshift=-0.5cm]
      {\begin{tikzpicture}[remember picture, overlay]
        \draw[fill=siyavula-gray, color=siyavula-gray] (0,0) rectangle
          (0.915\paperwidth,1.5cm);
        \node[anchor=west,text centered ,yshift=0.75cm, xshift=\hoffset+0.02\marginparwidth]
              { \begin{minipage}{0.85\textwidth}
                \color{black} #1
                \end{minipage}
                };
        \node[anchor=east,text centered, yshift=0.75cm, xshift=\hoffset+0.05\marginparwidth+1.1\textwidth]
              {\Large\color{black} };
       \end{tikzpicture}
      };
   \end{tikzpicture}
\addtocounter{shortcodecounter}{1}
  }
\titlespacing*{\subsection}{0cm}{1cm}{2cm}



\newcommand{\summary}[1]{
\vspace{6\baselineskip} \par
{\normalfont \sffamily\fontsize{22}\bfseries
\begin{tikzpicture}[remember picture,overlay]
    \node[anchor=west, xshift=-0.4\paperwidth]
      {\begin{tikzpicture}[remember picture, overlay]
        \draw[fill=siyavula-gray, color=siyavula-gray] (0,0) rectangle
          (1.2\paperwidth,2cm);
        \node[anchor=west,text centered ,yshift=1.cm, xshift=0.3\paperwidth]
              {  \phantom{xxx} \color{black} Chapter \chapterlabel | Summary  };
       \end{tikzpicture}
      };
   \end{tikzpicture}

}
\par
\vspace{\baselineskip}
\addcontentsline{toc}{section}{Summary}

See the summary presentation (\raisebox{-0.2em}{\includegraphics[height=1em]{../../icons/video.pdf}} Presentation: #1 at www.everythingmaths.co.za)

}


\newcommand{\solutionsheading}{
 \par  \vspace*{4\baselineskip}
{  \fontsize{12}\bfseries\itshape
\begin{tikzpicture}[remember picture,overlay]
    \node[anchor=west ,text centered]
      {\begin{tikzpicture}[remember picture, overlay]
        \draw[color=white, draw=black, line width=1pt] (0,0) rectangle
          (0.5\textwidth, 28pt);
       \node[anchor=west, yshift=14pt, xshift=4pt, text centered]
              { \bfseries ~ \color{black} Oplossings vir Oefening \chapterlabel~-~\arabic{exercisecounter}   };
       \end{tikzpicture}
    };
    
% now the gray bar to the end of the paragraph
    \node[anchor=west, xshift=0.52\textwidth]{
      \begin{tikzpicture}[remember picture, overlay]
        \draw[fill=white, color=white] (0,0) rectangle
          (0.5\textwidth,28pt);
       \end{tikzpicture}


      };
   \end{tikzpicture}

}

}


\newcommand{\exercisesheading}{
\addtocounter{exercisecounter}{1}
 \par  \vspace*{4\baselineskip}
{  \fontsize{12}\bfseries\itshape
\begin{tikzpicture}[remember picture,overlay]
    \node[anchor=west ,text centered]
      {\begin{tikzpicture}[remember picture, overlay]
        \draw[color=white, draw=black, line width=1pt] (0,0) rectangle
          (0.3\textwidth, 28pt);
       \node[anchor=west, yshift=14pt, xshift=4pt, text centered]
              { \bfseries ~ \color{black} Oefening \chapterlabel~-~\arabic{exercisecounter}   };
       \end{tikzpicture}
    };
    
% now the gray bar to the end of the paragraph
    \node[anchor=west, xshift=0.335\textwidth]{
      \begin{tikzpicture}[remember picture, overlay]
        \draw[fill=white, color=white] (0,0) rectangle
          (0.655\textwidth,28pt);
       \end{tikzpicture}


      };
   \end{tikzpicture}

}

%\vspace{\baselineskip}
}



\newcommand{\eocexercisesheading}{
\par \vspace*{3\baselineskip} 
{\normalfont \sffamily\fontsize{12}\bfseries\itshape
\begin{tikzpicture}[remember picture,overlay]
    \node[anchor=west ,text centered]
      {\begin{tikzpicture}[remember picture, overlay]
        \draw[color=white, draw=black, line width=1pt] (0,0) rectangle
          (0.475\textwidth, 28pt);
       \node[anchor=west, yshift=14pt, xshift=4pt, text centered]
              { \bfseries ~ \color{black}  Einde van Hoofstuk Oefeninge};
       \end{tikzpicture}
    };
    
% now the gray bar to the end of the paragraph
\end{tikzpicture}

}

}


\newcommand{\eocsolutionsheading}{
\par \vspace*{3\baselineskip} 
{\normalfont \sffamily\fontsize{12}\bfseries\itshape
\begin{tikzpicture}[remember picture,overlay]
    \node[anchor=west ,text centered]
      {\begin{tikzpicture}[remember picture, overlay]
        \draw[color=white, draw=black, line width=1pt] (0,0) rectangle
          (0.65\textwidth, 28pt);
       \node[anchor=west, yshift=14pt, xshift=4pt, text centered]
              { \bfseries ~ \color{black} Oplossings vir Einde van hoofstuk oefeninge};
       \end{tikzpicture}
    };
    
\end{tikzpicture}

}

}
